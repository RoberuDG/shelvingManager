# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file '.\Main.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from sqlite3 import Cursor, Error
from PyQt5 import QtCore, QtGui, QtWidgets

from shelvingManager.Backend.Controller.database_controller import DatabaseController
from shelvingManager.Backend.Controller.item_controller import ItemController
from shelvingManager.Backend.Controller.item_type_controller import ItemTypeController
from shelvingManager.Backend.Controller.room_controller import RoomController
from shelvingManager.Backend.Controller.shelving_controller import ShelvingController
from shelvingManager.Backend.Controller.shelf_controller import ShelfController
from shelvingManager.Models.room import Room


class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(1711, 853)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.itemsWidget = QtWidgets.QTreeWidget(self.centralwidget)
        self.itemsWidget.setGeometry(QtCore.QRect(0, 0, 421, 811))
        self.itemsWidget.setObjectName("itemsWidget")
        self.frame = QtWidgets.QFrame(self.centralwidget)
        self.frame.setGeometry(QtCore.QRect(440, 0, 801, 811))
        self.frame.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.frame.setObjectName("frame")
        self.gridLayoutWidget = QtWidgets.QWidget(self.frame)
        self.gridLayoutWidget.setGeometry(QtCore.QRect(0, 0, 801, 811))
        self.gridLayoutWidget.setObjectName("gridLayoutWidget")
        self.gridLayout = QtWidgets.QGridLayout(self.gridLayoutWidget)
        self.gridLayout.setSizeConstraint(QtWidgets.QLayout.SetMaximumSize)
        self.gridLayout.setContentsMargins(0, 0, 0, 0)
        self.gridLayout.setObjectName("gridLayout")
        self.line = QtWidgets.QFrame(self.centralwidget)
        self.line.setGeometry(QtCore.QRect(420, 0, 21, 811))
        self.line.setFrameShape(QtWidgets.QFrame.VLine)
        self.line.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line.setObjectName("line")
        self.propertyList = QtWidgets.QListView(self.centralwidget)
        self.propertyList.setGeometry(QtCore.QRect(1260, 0, 331, 381))
        self.propertyList.setObjectName("propertyList")
        self.line_2 = QtWidgets.QFrame(self.centralwidget)
        self.line_2.setGeometry(QtCore.QRect(1240, 0, 21, 811))
        self.line_2.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_2.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_2.setObjectName("line_2")
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 1711, 21))
        self.menubar.setObjectName("menubar")
        self.menuEditar = QtWidgets.QMenu(self.menubar)
        self.menuEditar.setObjectName("menuEditar")
        self.menuRoom = QtWidgets.QMenu(self.menuEditar)
        self.menuRoom.setObjectName("menuRoom")
        self.menuEstanter_a = QtWidgets.QMenu(self.menuEditar)
        self.menuEstanter_a.setObjectName("menuEstanter_a")
        self.menuBalda = QtWidgets.QMenu(self.menuEditar)
        self.menuBalda.setObjectName("menuBalda")
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)
        self.actionEliminar_habitaci_n = QtWidgets.QAction(MainWindow)
        self.actionEliminar_habitaci_n.setObjectName(
            "actionEliminar_habitaci_n")
        self.actionEliminar_habitaci_n_2 = QtWidgets.QAction(MainWindow)
        self.actionEliminar_habitaci_n_2.setObjectName(
            "actionEliminar_habitaci_n_2")
        self.actionNewRoom = QtWidgets.QAction(MainWindow)
        self.actionNewRoom.setObjectName("actionNewRoom")
        self.actionDeleteRoom = QtWidgets.QAction(MainWindow)
        self.actionDeleteRoom.setObjectName("actionDeleteRoom")
        self.actionEditRoom = QtWidgets.QAction(MainWindow)
        self.actionEditRoom.setObjectName("actionEditRoom")
        self.actionCrear_estanter_a = QtWidgets.QAction(MainWindow)
        self.actionCrear_estanter_a.setObjectName("actionCrear_estanter_a")
        self.actionEditar_estanter_a = QtWidgets.QAction(MainWindow)
        self.actionEditar_estanter_a.setObjectName("actionEditar_estanter_a")
        self.actionEliminar_estanter_a = QtWidgets.QAction(MainWindow)
        self.actionEliminar_estanter_a.setObjectName(
            "actionEliminar_estanter_a")
        self.actionA_adir_balda = QtWidgets.QAction(MainWindow)
        self.actionA_adir_balda.setObjectName("actionA_adir_balda")
        self.actionEliminar_balda = QtWidgets.QAction(MainWindow)
        self.actionEliminar_balda.setObjectName("actionEliminar_balda")
        self.menuRoom.addAction(self.actionNewRoom)
        self.menuRoom.addAction(self.actionEditRoom)
        self.menuRoom.addSeparator()
        self.menuRoom.addAction(self.actionDeleteRoom)
        self.menuEstanter_a.addAction(self.actionCrear_estanter_a)
        self.menuEstanter_a.addAction(self.actionEditar_estanter_a)
        self.menuEstanter_a.addSeparator()
        self.menuEstanter_a.addAction(self.actionEliminar_estanter_a)
        self.menuBalda.addAction(self.actionA_adir_balda)
        self.menuBalda.addSeparator()
        self.menuBalda.addAction(self.actionEliminar_balda)
        self.menuEditar.addAction(self.menuRoom.menuAction())
        self.menuEditar.addAction(self.menuEstanter_a.menuAction())
        self.menuEditar.addAction(self.menuBalda.menuAction())
        self.menubar.addAction(self.menuEditar.menuAction())

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "MainWindow"))
        self.itemsWidget.headerItem().setText(
            0, _translate("MainWindow", "Habitaciones"))
        self.itemsWidget.headerItem().setText(1, _translate("MainWindow", "Estanterías"))
        self.itemsWidget.headerItem().setText(2, _translate("MainWindow", "Baldas"))
        self.itemsWidget.headerItem().setText(3, _translate("MainWindow", "Objetos"))
        self.menuEditar.setTitle(_translate("MainWindow", "Editar"))
        self.menuRoom.setTitle(_translate("MainWindow", "Habitación"))
        self.menuEstanter_a.setTitle(_translate("MainWindow", "Estantería"))
        self.menuBalda.setTitle(_translate("MainWindow", "Balda"))
        self.actionEliminar_habitaci_n.setText(
            _translate("MainWindow", "Eliminar habitación"))
        self.actionEliminar_habitaci_n_2.setText(
            _translate("MainWindow", "Eliminar habitación"))
        self.actionNewRoom.setText(_translate(
            "MainWindow", "Crear nueva habitación"))
        self.actionDeleteRoom.setText(_translate(
            "MainWindow", "Eliminar habitación"))
        self.actionEditRoom.setText(_translate(
            "MainWindow", "Editar habitación"))
        self.actionCrear_estanter_a.setText(
            _translate("MainWindow", "Añadir estantería"))
        self.actionEditar_estanter_a.setText(
            _translate("MainWindow", "Editar estantería"))
        self.actionEliminar_estanter_a.setText(
            _translate("MainWindow", "Eliminar estantería"))
        self.actionA_adir_balda.setText(
            _translate("MainWindow", "Añadir balda"))
        self.actionEliminar_balda.setText(
            _translate("MainWindow", "Eliminar balda"))

    # *Método para cargar la vista de árbol de los objetos
    def populate_templates(self, cur):
        rooms = RoomController.get_all_rooms(cur)
        for room in rooms:
            child = QtWidgets.QTreeWidgetItem(self.itemsWidget)
            child.setText(0, room.name)
            self.itemsWidget.addTopLevelItem(child)
            shelvings = ShelvingController.get_shelvings_by_room_id(
                room.id, cur)
            for shelving in shelvings:
                child2 = QtWidgets.QTreeWidgetItem(child)
                child2.setText(1, shelving.code)
                child.addChild(child2)
                shelves = ShelfController.get_shelve_by_shelving_id(
                    shelving.id, cur)
                for shelf in shelves:
                    child3 = QtWidgets.QTreeWidgetItem(child2)
                    child3.setText(2, shelf.code)
                    child2.addChild(child3)
                    items = ItemController.get_items_by_shelf_id(
                        shelf.id, cur)
                    for item in items:
                        child4 = QtWidgets.QTreeWidgetItem(child3)
                        child4.setText(3, item.name)
                        child3.addChild(child4)

    def insert_room(self, room: Room, cur: Cursor):
        RoomController.insert_room(room, cur)


def connect_to_db():
    try:
        conn = DatabaseController.connect_to_database()
        # DatabaseController.create_database(conn)
        return conn
    except Error as e:
        print(e)
        return None


if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    conn = connect_to_db()
    ui.populate_templates(conn)
    conn.close()
    MainWindow.show()
    sys.exit(app.exec_())